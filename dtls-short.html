<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Extensions for Datagram Transport Layer Security (TLS) in Low Bandwidth Environments</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Extensions for Datagram Transport Layer Security (TLS) in Low Bandwidth Environments">
<meta name="generator" content="xml2rfc v1.30 (http://xml.resource.org/)">
<style type='text/css'>
<!--
    body {
        font-family: verdana, charcoal, helvetica, arial, sans-serif;
        margin: 2em;
        font-size: small ; color: #000000 ; background-color: #ffffff ; }
    .title { color: #990000; font-size: x-large ;
        font-weight: bold; text-align: right;
        font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
        background-color: transparent; }
    .filename { color: #666666; font-size: 18px; line-height: 28px;
        font-weight: bold; text-align: right;
        font-family: helvetica, arial, sans-serif;
        background-color: transparent; }
    td.rfcbug { background-color: #000000 ; width: 30px ; height: 30px ;
        text-align: justify; vertical-align: middle ; padding-top: 2px ; }
    td.rfcbug span.RFC { color: #666666; font-weight: bold; text-decoration: none;
        background-color: #000000 ;
        font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
        font-size: x-small ; }
    td.rfcbug span.hotText { color: #ffffff; font-weight: normal; text-decoration: none;
        text-align: center ;
        font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
        font-size: x-small ; background-color: #000000; }
    /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
    div#counter{margin-top: 100px}

    a.info{
        position:relative; /*this is the key*/
        z-index:24;
        text-decoration:none}

    a.info:hover{z-index:25; background-color:#990000 ; color: #ffffff ;}

    a.info span{display: none}

    a.info:hover span.info{ /*the span will display just on :hover state*/
        display:block;
        position:absolute;
        font-size: smaller ;
        top:2em; left:2em; width:15em;
        padding: 2px ;
        border:1px solid #333333;
        background-color:#eeeeee; color:#990000;
        text-align: left ;}

     A { font-weight: bold; }
     A:link { color: #990000; background-color: transparent ; }
     A:visited { color: #333333; background-color: transparent ; }
     A:active { color: #333333; background-color: transparent ; }

    p { margin-left: 2em; margin-right: 2em; }
    p.copyright { font-size: x-small ; }
    p.toc { font-size: small ; font-weight: bold ; margin-left: 3em ;}
    table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
    td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

    span.emph { font-style: italic; }
    span.strong { font-weight: bold; }
    span.verb, span.vbare { font-family: "Courier New", Courier, monospace ; }

    span.vemph { font-style: italic; font-family: "Courier New", Courier, monospace ; }
    span.vstrong { font-weight: bold; font-family: "Courier New", Courier, monospace ; }
    span.vdeluxe { font-weight: bold; font-style: italic; font-family: "Courier New", Courier, monospace ; }

    ol.text { margin-left: 2em; margin-right: 2em; }
    ul.text { margin-left: 2em; margin-right: 2em; }
    li { margin-left: 3em;  }

    pre { margin-left: 3em; color: #333333;  background-color: transparent;
        font-family: "Courier New", Courier, monospace ; font-size: small ;
        text-align: left;
        }

    h3 { color: #333333; font-size: medium ;
        font-family: helvetica, arial, sans-serif ;
        background-color: transparent; }
    h4 { font-size: small; font-family: helvetica, arial, sans-serif ; }

    table.bug { width: 30px ; height: 15px ; }
    td.bug { color: #ffffff ; background-color: #990000 ;
        text-align: center ; width: 30px ; height: 15px ;
         }
    td.bug A.link2 { color: #ffffff ; font-weight: bold;
        text-decoration: none;
        font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
        font-size: x-small ; background-color: transparent }

    td.header { color: #ffffff; font-size: x-small ;
        font-family: arial, helvetica, sans-serif; vertical-align: top;
        background-color: #666666 ; width: 33% ; }
    td.author { font-weight: bold; margin-left: 4em; font-size: x-small ; }
    td.author-text { font-size: x-small; }
    table.full { vertical-align: top ; border-collapse: collapse ;
        border-style: solid solid solid solid ;
        border-color: black black black black ;
        font-size: small ; text-align: center ; }
    table.headers, table.none { vertical-align: top ; border-collapse: collapse ;
        border-style: none;
        font-size: small ; text-align: center ; }
    table.full th { font-weight: bold ;
        border-style: solid ;
        border-color: black black black black ; }
    table.headers th { font-weight: bold ;
        border-style: none none solid none;
        border-color: black black black black ; }
    table.none th { font-weight: bold ;
        border-style: none; }
    table.full td {
        border-style: solid solid solid solid ;
        border-color: #333333 #333333 #333333 #333333 ; }
    table.headers td, table.none td { border-style: none; }

    hr { height: 1px }
-->
</style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">N. Modadugu</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Stanford University</td></tr>
<tr><td class="header">Expires: August 29, 2006</td><td class="header">E. Rescorla</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Network Resonance</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 25, 2006</td></tr>
</table></td></tr></table>
<div align="right"><span class="title"><br />Extensions for Datagram Transport Layer Security (TLS) in Low Bandwidth Environments</span></div>
<div align="right"><span class="title"><br />draft-modadugu-dtls-short-00.txt</span></div>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 29, 2006.</p>

<h3>Copyright Notice</h3>
<p>
Copyright &copy; The Internet Society (2006).</p>

<h3>Abstract</h3>

<p>
This document describes a series of extensions to Datagram Transport Layer
Security (DTLS) which 
reduce the per-record bandwidth of the data channel. 
These extensions apply only to the on-the-wire representation
of the protocol and do not affect cryptographic
processing.
	   
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Conventions Used In This Document<br />
<a href="#anchor3">2.</a>&nbsp;
Background<br />
<a href="#anchor4">3.</a>&nbsp;
Sequence Number Length<br />
<a href="#anchor5">4.</a>&nbsp;
Version Field Elimination<br />
<a href="#anchor6">5.</a>&nbsp;
Length Field Elimination<br />
<a href="#anchor7">6.</a>&nbsp;
Implicit Application Data Header<br />
<a href="#anchor8">7.</a>&nbsp;
Security Considerations<br />
<a href="#anchor9">8.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;Introduction</h3>

<p>
Datagram Transport Layer Security (DTLS) <a class="info" href="#I-D.rescorla-dtls">[5]<span> (</span><span class="info">Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; June&nbsp;2005.</span><span>)</span></a> is a protocol
which provides channel-oriented communications security for datagram
traffic.  A communication channel that uses DTLS as security protocol
incurs some bandwidth overhead that results from additional per-record
headers and encryption overhead.  Reducing this bandwidth overhead is
desireable when DTLS is used in wireless environments or to secure
real-time traffic.


This document describes a series of extensions to DTLS which 
reduce the per-record bandwidth.  These extensions apply only to the on-the-wire representation
of the protocol and do not affect the data subject to cryptographic
processing.

</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;Conventions Used In This Document</h3>

<p>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in 
<a class="info" href="#RFC2119">[2]<span> (</span><span class="info">Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.

</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;Background</h3>

<p>
The DTLS record format (based on the TLS 
<a class="info" href="#I-D.ietf-tls-rfc2246-bis">[3]<span> (</span><span class="info">Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol Version 1.1,&rdquo; June&nbsp;2005.</span><span>)</span></a> record format)
is shown below:

</p><pre>
       struct {
        ContentType type;
        ProtocolVersion version;
        uint16 epoch;
        uint48 sequence_number;
        uint16 length;
        opaque fragment[DTLSPlaintext.length];
       } DTLSPlaintext;
</pre>
<p>
The major sources of per-record overhead in DTLS are:

</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="80%"><col align="right" width="20%">
<tr><th align="left">Field</th><th align="right">size(bytes)</th></tr>
<tr>
<td align="left">type</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">version</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">epoch</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">sequence_number</td>
<td align="right">6</td>
</tr>
<tr>
<td align="left">length</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">MAC</td>
<td align="right">10-20 bytes</td>
</tr>
<tr>
<td align="left">encryption overhead</td>
<td align="right">9-32</td>
</tr>
</table>

<p>
The largest performance improvement can be obtained by moving to
a cipher suite with less overhead. 
DTLS-CTR <a class="info" href="#I-D.modadugu-tls-ctr">[7]<span> (</span><span class="info">Modadugu, N. and E. Rescorla, &ldquo;AES Counter Mode Cipher Suites for           TLS and DTLS,&rdquo; October&nbsp;2005.</span><span>)</span></a> describes such a mode. This document describes
how to reduce packet size further by reducing the size of some
of the fields in the record.

</p>
<p>
All the optimizations described in this memo are implemented
using the TLS Extensions mechanism <a class="info" href="#I-D.ietf-tls-rfc3546bis">[4]<span> (</span><span class="info">Blake-Wilson, S., &ldquo;Transport Layer Security (TLS) Extensions,&rdquo; October&nbsp;2005.</span><span>)</span></a>.

</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;Sequence Number Length</h3>

<p>
TLS, on which DTLS is based, uses a 64-bit sequence number. However,
because TLS must run on a reliable protocol, the sequence number
is implicit and does not take up space on the wire. In DTLS, the
sequence number is explicit and broken up into a 16-bit "epoch"
describing the number of handshakes that have happened on this 
association and a 48-bit per-epoch sequence number. This has
the advantage of simplicity, but the disadvantage of taking up
a fair amount of space in the packet.

</p>
<p>
The sequence_number_length extension shortens the on-the-wire
representation of the sequence number without shortening the
actual sequence number. This means that the high order bits
are not present in the packet but rather MUST be deduced.
Implementations SHOULD use the technique of Appendix A of
<a class="info" href="#I-D.ietf-ipsec-esp-v3">[6]<span> (</span><span class="info">Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; March&nbsp;2005.</span><span>)</span></a> to compute the high
order bits of the sequence number and epoch number.

</p>
<p>
When the client sends the sequence_number_length extension
"extension_data" field must contain a SequenceNumberLengthValues field:

</p><pre>
  uint8 SequenceNumberLengthValue;
  SequenceNumberLengthValue SequenceNumberLengthValues&lt;1..7&gt;;
</pre>
<p>
This field contains the sequence number lengths which the
client is willing to accept. These lengths are the combined
length in bytes of the sequence number and epoch. Permissible
values are 2,3,4,5,6,7,8, with the sequence number and epoch
divided up according to the following table:

</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="34%"><col align="right" width="33%"><col align="right" width="33%">
<tr><th align="left">Total</th><th align="right">Epoch</th><th align="right">Sequence</th></tr>
<tr>
<td align="left">2</td>
<td align="right">2 bits</td>
<td align="right">14 bits</td>
</tr>
<tr>
<td align="left">3</td>
<td align="right">4 bits</td>
<td align="right">20 bits</td>
</tr>
<tr>
<td align="left">4</td>
<td align="right">6 bits</td>
<td align="right">26 bits</td>
</tr>
<tr>
<td align="left">5</td>
<td align="right">1 byte</td>
<td align="right">4 bytes</td>
</tr>
<tr>
<td align="left">6</td>
<td align="right">1 byte</td>
<td align="right">5 bytes</td>
</tr>
<tr>
<td align="left">7</td>
<td align="right">1 byte</td>
<td align="right">6 bytes</td>
</tr>
<tr>
<td align="left">8</td>
<td align="right">2 bytes</td>
<td align="right">6 bytes</td>
</tr>
</table>

<p>
When the sequence number crosses a byte boundary, the high
order bits of that byte SHALL be considered to be the epoch
and the low order bits SHALL be considered to be the high
order bits of the sequence number. Note that the 8-byte 
value is equivalent to the default DTLS behavior and is provided
purely for completeness.

</p>
<p>
If the server receives a SequenceNumberLengthValue that is not one
of the allowed values, it MUST abort the handshake with an "illegal_parameter"
alert. If the server receives a sequence_number_length extension
and does not wish to negotiate sequence_number_length it should 
ignore the sequence_number_length extension.

</p>
<p>
If the server wishes to negotiate sequence_number_length it responds
with its own sequence_number_length extension. The server's
"extension_data" field for this extension shall consist of a single
SequenceNumberLengthValue value, which MUST be selected from the list
provided by the client. If the client receives a SequenceNumberLengthValue
that was not on its supplied list, it MUST abort the handshake
with an "illegal_parameter" exception.

</p>
<p>
The new sequence number length takes effect following the
change_cipher_spec for the new cipher suite.
Because the epoch
value is used to differentiate data from different cipher suite
states (different negotiations) care must be taken when 
renegotiating sequence number length during active data transfer.
In the worst case scenario, the receiver may need to try to
parse/decrypt the packet under both potential state settings.
Because only one produces a valid parse with a valid MAC, the
correct choice is unambiguous.

</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;Version Field Elimination</h3>

<p>
Every TLS/DTLS record contains a two-byte version field. This
field is mostly redundant because the correct version is negotiated
during the TLS/DTLS handshake. The NoVersionField extension
eliminates the version field from the wire representation.

</p>
<p>
In order to negotiate the non-use of the version field
clients MAY include an extension of type "no_version_field" in
the extended client hello. The "extension_data" field of this
extension shall be empty.

</p>
<p>
Servers that receive an extended hello containing a "no_version_field"
extension, MAY agree to omit the version field including an
extension of type "no_version_field", with empty "extension_data", in
the extended server hello.

</p>
<p>
Once the "no_version_field" extension is negotiated, packets in
the newly negotiated association (i.e., after the change_cipher_spec)
SHALL omit the version field. This does
not affect the computation of the HMAC, which MUST include the
version field as negotiated by the DTLS handshake, i.e., as it would
have been included in the header.

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;Length Field Elimination</h3>

<p>
DTLS records contain a length field, which allows more than 
one record to be carried in a single datagram (though each
record must fit inside a single datagram). However, if the
peers agree to place only one record per datagram, the
length field becomes superfluous. The "no_length_field" 
extension is used to make this agreement.

</p>
<p>
In order to negotiate the non-use of the length field
clients MAY include an extension of type "no_length_field" in
the extended client hello. The "extension_data" field of this
extension shall be empty.

</p>
<p>
Servers that receive an extended hello containing a "no_length_field"
extension, MAY agree to omit the length field including an
extension of type "no_length_field", with empty "extension_data", in
the extended server hello.

</p>
<p>
Once the "no_length_field" extension is negotiated, packets in
the newly negotiated association (i.e., after the change_cipher_spec)
SHALL omit the length field. This does
not affect the computation of the HMAC, which MUST include the
length field as negotiated by the DTLS handshake, i.e., as it would
have been included in the header. When the "no_length_field"
extension is in effect, implementations MUST NOT place more than
one record per datagram.

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;Implicit Application Data Header</h3>

<p>
In principle, because all the data in the DTLS header is incorporated
into the DTLS record MAC, the entire header can be omitted and 
reconstructed by trying all candidate headers. We propose a somewhat
less radical approach: omitting the header for records of type
"application_data". Because these records comprise the majority
of the traffic on a DTLS connection, this extension provides a
significant optimization while minimizing ambiguity. 

</p>
<p>
In order to negotiate the implicit application data header,
clients MAY include an extension of type "implicit_header" in
the extended client hello. The "extension_data" field of this
extension shall be empty.

</p>
<p>
Servers that receive an extended hello containing a "implicit_header"
extension, MAY agree to this optimization
extension of type "implicit_header", with empty "extension_data", in
the extended server hello.

</p>
<p>
Once the "implicit_header" extension is negotiated, 
application data records in
the newly negotiated association (i.e., after the change_cipher_spec)
SHOULD omit the following values in the DTLS header:
</p>
<blockquote class="text">
<li>Content type
</li>
<li>Version
</li>
<li>Length
</li>
<li>Sequence Number
</li>
</blockquote><p>
This does
not affect the computation of the HMAC, which MUST include these
values as if they were present. In addition, as with the 
"no_length_field" extension, there must only be one 
record per transport-level datagram.

</p>
<p>
The "implicit_header" extension introduces some ambiguity in record
receipt processing. This ambiguity can, however, be resolved by
trial decryption. Implementations MAY use the algorithm described
below in order to properly receive a given record. The initial
value of ESN (the expected sequence number) is set to 1 + (sequence number of the Finished message record), which should be the sequence number
of the first application data record.
</p>
<ol class="text">
<li>If the first byte does not match a known content type go to step 5.
</li>
<li>If the version field does not match the current version go to step 5.
</li>
<li>If the length does not match the rest of the record, go to step 5.
</li>
<li>Attempt to decrypt the record as a record with header present. If the MAC verifies, set ESN to the record sequence number+1 and pass the record it to the next layer. Otherwise, proceed to step 5.
</li>
<li>Prepend an application_data header with sequence number of ESN. Attempt to
decrypt. If the MAC checks, set ESN to the record sequence number+1 and pass
the record to the next layer. 
</li>
<li>Repeat step 5 with all ESN values in the current replay window. 
</li>
<li>If no valid ESN can be found, discard the record.
</li>
</ol><p>

</p>
<p>
The above algorithm is generic. However, in applications where
an application layer sequence number is present in plaintext in 
the record payload (see TODO) (e.g., RTP), it MAY be appropriate
to maintain an offset between the two sequence numbers and use that
to generate the initial ESN estimate in step 5. However, they MUST
still use the sequence number of the last valid packet to set the
replay--and hence resynchronization--window.

</p>
<p>
Note that although in principle this specification allows the
inter-mixture of application_data records with and without the
header, senders SHOULD generally send records without the header
when the extension is in effect. The one reasonable exception would
be if an application layer sequence number is present and makes
a large jump. Implementations MAY add an explicit application_data
header to several frames to effect a resynchronization.

</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;Security Considerations</h3>

<p>
There are two security concerns introduced by these extensions. The
first involves the security of the negotiation and the second
the security of the transport protocol. Because the negotiation
is protected by the TLS/DTLS handshake, attackers can neither force
the use of these extensions nor block them while allowing the
negotiation to succeed. 

</p>
<p>
Although these extensions involve changing the bits on the wire,
the transformations involved are made in authenticated but unencrypted
data. This has two implications: (1) Any attacker who possesses the
encrypted stream of an ordinary DTLS connection can generate a
stream with any or all of these fields removed. Thus, if a
connection uses these extensions and is weak, the underlying
TLS connection must be weak as well. (2) Although the receiver
needs to deduce certain values, this does not produce a security
threat because the attacker could have replaced the real values
on the wire with the values that the receiver deduces in the
low bandwidth version. In both cases, what stops tampering is
the use of a strong MAC.

</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;IANA Considerations</h3>

<p>
This document defines four new extensions for DTLS, in
accordance with <a class="info" href="#I-D.ietf-tls-rfc3546bis">[4]<span> (</span><span class="info">Blake-Wilson, S., &ldquo;Transport Layer Security (TLS) Extensions,&rdquo; October&nbsp;2005.</span><span>)</span></a>:

</p><pre>
  enum { sequence_number_length (??), no_version_field (??),
         no_length_field(??), implicit_header (??)} ExtensionType;
</pre>
<p>
   [[ NOTE: These values need to be assigned by IANA ]]

</p>
<p>
The "sequence_number_length", "no_length_field" and
"implicit_header" extensions 
MAY only be used with DTLS and MUST NOT be used with TLS.
The "no_version_field" extension MAY be used with either 
DTLS or TLS.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1889">[1]</a></td>
<td class="author-text"><a href="mailto:schulzrinne@fokus.gmd.de">Schulzrinne, H.</a>, <a href="mailto:casner@precept.com">Casner, S.</a>, <a href="mailto:frederic@parc.xerox.com">Frederick, R.</a>, and <a href="mailto:van@ee.lbl.gov">V. Jacobson</a>, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc1889.txt">RTP: A Transport Protocol for Real-Time Applications</a>,&rdquo; RFC&nbsp;1889, January&nbsp;1996.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[2]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tls-rfc2246-bis">[3]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc2246-bis-13.txt">The TLS Protocol Version 1.1</a>,&rdquo; draft-ietf-tls-rfc2246-bis-13 (work in progress), June&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tls-rfc3546bis">[4]</a></td>
<td class="author-text">Blake-Wilson, S., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc3546bis-02.txt">Transport Layer Security (TLS) Extensions</a>,&rdquo; draft-ietf-tls-rfc3546bis-02 (work in progress), October&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.rescorla-dtls">[5]</a></td>
<td class="author-text">Rescorla, E. and N. Modadugu, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-rescorla-dtls-05.txt">Datagram Transport Layer Security</a>,&rdquo; draft-rescorla-dtls-05 (work in progress), June&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipsec-esp-v3">[6]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipsec-esp-v3-10.txt">IP Encapsulating Security Payload (ESP)</a>,&rdquo; draft-ietf-ipsec-esp-v3-10 (work in progress), March&nbsp;2005.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.modadugu-tls-ctr">[7]</a></td>
<td class="author-text"><a href="mailto:nagendra@cs.stanford.edu">Modadugu, N.</a> and <a href="mailto:ekr@networkresonance.com">E. Rescorla</a>, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-modadugu-tls-ctr-00.txt">AES Counter Mode Cipher Suites for
          TLS and DTLS</a>,&rdquo; draft-modadugu-tls-ctr-00 (work in progress), October&nbsp;2005.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nagendra Modadugu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stanford University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">353 Serra Mall</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stanford, CA  94305</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:nagendra@cs.stanford.edu">nagendra@cs.stanford.edu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Eric Rescorla</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Network Resonance</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2483 E. Bayshore Rd., #212</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Palo Alto, CA  94303</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ekr@networkresonance.com">ekr@networkresonance.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Intellectual Property Statement</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
<h3>Disclaimer of Validity</h3>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS OR IS SPONSORED BY (IF ANY),
THE INTERNET SOCIETY AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM
ALL WARRANTIES,
EXPRESS OR IMPLIED,
INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.</p>
<h3>Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The Internet Society (2006).
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<h3>Acknowledgment</h3>
<p class='copyright'>
Funding for the RFC Editor function is currently provided by the
Internet Society.</p>
</body></html>
