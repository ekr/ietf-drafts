


Network Working Group                                        E. Rescorla
Internet-Draft                                                RTFM, Inc.
Intended status:  Standards Track                            C. Jennings
Expires:  September 1, 2008                                        Cisco
                                                       February 29, 2008


                   Untangling Identity in SIP Systems
                    draft-rescorla-sip-identity.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on September 1, 2008.

Copyright Notice

   Copyright (C) The IETF Trust (2008).

Abstract

   There has been a lot of recent discussion about how to securely
   identify principals in SIP systems.  This document attempts to
   clarify the inherent technical limits of this effort and the
   capabilities offered by certain schemes.






Rescorla & Jennings     Expires September 1, 2008               [Page 1]

Internet-Draft                SIP Identity                 February 2008


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . 3
   2.  Background: Identity in the PSTN  . . . . . . . . . . . . . . . 3
     2.1.  PSTN Topology . . . . . . . . . . . . . . . . . . . . . . . 4
     2.2.  Routing Integrity . . . . . . . . . . . . . . . . . . . . . 4
     2.3.  Caller Identification . . . . . . . . . . . . . . . . . . . 5
   3.  References  . . . . . . . . . . . . . . . . . . . . . . . . . . 6
     3.1.  Normative References  . . . . . . . . . . . . . . . . . . . 6
     3.2.  Informational References  . . . . . . . . . . . . . . . . . 6
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . . . 6
   Intellectual Property and Copyright Statements  . . . . . . . . . . 8







































Rescorla & Jennings     Expires September 1, 2008               [Page 2]

Internet-Draft                SIP Identity                 February 2008


1.  Introduction

   From the perspective of the communicating parties, the "identity"
   service that they want is simple:  to know that the person on the
   other end of the line is who they think it is.  Because of the
   asymmetric nature of telephony, this actually represents two
   different services, one from the perspective of the caller and one
   from the perspective of the callee:
   Routing Integrity  The caller knows who he is trying to call--indeed
      he entered their number into his phone.  The service the caller
      wants is ROUTING INTEGRITY:  namely that the person he is talking
      to actually is who he intended to call.  This service is
      complicated to some extent by retargeting services such as call
      forwarding, but in those cases the caller wants to know that the
      retargeting was authorized by the intended recipient.
   Caller Identification  Unlike the caller, the callee generally does
      not have a preconceived idea of who he is trying to call.  Rather,
      his phone rings and he wants to know who is calling.  The service
      he wants is CALLER IDENTIFICATION.
   It is important to note that regardless of the technological means
   used to provide these services, they are extremely different
   conceptually.  ROUTING INTEGRITY is a verification problem:  the
   system needs to verify that you reached the person you were trying to
   reach.  By contrast, CALLER IDENTIFICATION is an information
   provision problem.

   A variety of technical mechanisms have been proposed (and are in use)
   to provide these services for SIP-based telephony.  Recently,
   questions have been raised about the suitability of one such
   mechanism:  SIP Identity [RFC4474].  This draft is intended to
   provide a broader perspective on the identity problem, the inherent
   technical limitations on potential solutions, and the capabilities of
   the existing approaches.


2.  Background: Identity in the PSTN

   Before addressing identity in SIP systems, it is useful to start with
   identity in the PSTN.  The two most important facts about identity in
   the PSTN are these:
      The only valid identifiers were phone numbers.
      The PSTN is a fundamentally closed system with no security real
      security mechanisms to prevent insider attack.
   As we shall see, these two properties allow for only a fairly limited
   set of identity services.






Rescorla & Jennings     Expires September 1, 2008               [Page 3]

Internet-Draft                SIP Identity                 February 2008


2.1.  PSTN Topology

   The PSTN is a hub-and-spoke topology, as shown below:

             Sub. 1 ----+                            +---- Sub. 4
                         \           Trunk          /
             Sub. 2 ------ CO-1 --------------- CO-2------ Sub. 5
                         /                          \
             Sub. 3 ----+                            +---- Sub. 6


   Each subscriber is connected by a physical circuit to a switch in
   their local CENTRAL OFFICE (CO).  Although there may be multiple
   phones in a single house, they are all electrically connected on the
   same local loop and are indistinguishable from the perspective of the
   CO Therefore, all phones on the same local loop have the same phone
   number.

   The CO is connected to other COs via trunk lines, which are used to
   carry calls in between COs.  Similarly, providers can connect to each
   other at dedicated switches which only serve to switch traffic and
   don't have any subscribers directly attached to them.  All of these
   connections are digital and speak SS7.  The CO switch is the analog/
   digital boundary.

2.2.  Routing Integrity

   From the very beginning, of telephony systems, it has been assumed
   that they provide routing integrity.  This was historically viewed
   more as a correctness guarantee as a security guarantee--if your
   phone calls don't go the right place, there's not much point in
   having a phone--but it is of course also a security guarantee.

   When a subscriber wants to call another subscriber, they enter the
   phone number on the phone and it gets transmitted over the analog
   voice channel in DTMF (again, we're just talking about the basic
   analog case).  The DTMF decoder at the CO switch decodes the DTMF and
   determines which number the caller intends to call.  If the number is
   assigned to that CO (and if the CO has an authoritative copy of which
   numbers have been ported), it can handle it locally.  If the number
   is not assigned to that switch, then the call needs to be routed to
   another switch.

   This routing information isn't kept locally, at least in the US.
   Instead, the switch needs to consult a numbering plan database [TODO:
   need the right name here] in order to determine which provider/switch
   controls that number.  Once that is done, the switch routes the call
   down the appropriate trunk towards the appropriate destination.



Rescorla & Jennings     Expires September 1, 2008               [Page 4]

Internet-Draft                SIP Identity                 February 2008


   This system provides a relatively high degree of routing integrity
   provided that two invariants are preserved:
   o  The inter-switch interconnects are kept secure.
   o  The connection to the numbering database (and the database itself)
      is secure.
   Both of these invariants are enforced through having a closed system.
   The connections between the switches are not virtual but rather are
   manually configured physical circuits, so impersonating one switch to
   another is a matter of actually interfering with that cable.  The
   connection to the database is similarly manually configured [Note:  I
   don't know if this is physical or over the Internet, but this
   obviously isn't an architectural issue.]

   Both of these invariants, however, are very brittle against insider
   attack.  An attacker who controls a switch can reroute all calls that
   would pass through it [securityfocus-call-theft].  An attacker who
   controls the numbering database can inject arbitrary routes.  The
   basic assumption is that insiders will not attempt to attack the
   system.

2.3.  Caller Identification

   Unlike routing integrity, caller identification is a relatively
   recent feature of common phone systems, where it is typically
   referred to as CALLER ID (CID) in residential systems or AUTOMATIC
   NUMBER IDENTIFICATION (ANI) in call centers.  Both systems work
   roughly the same way.  The typical residential presentation is a one
   or two line display that shows the phone number of the calling party
   as well as their name.

   In the PSTN CID is provided by having the originating switch indicate
   (in the SS7 signaling) the calling party's phone number.  This is
   then modulated over the analog carrier for display on the callee's
   phone.  If the caller's name is provided, it is determined by the
   callee's local switch, which needs to do a database lookup against a
   third party database.

   Somewhat surprisingly, there is no enforcement whatsoever of the
   correctness of the provided number.  The originator simply asserts it
   and it is trusted by the receiver.  In principle, it might be
   possible to do some sort of inbound route filtering using the
   numbering database (although that would only provide hop-by-hop
   assurance similar to that provided by uPRF) but in practice this is
   not done.

   The ability to forge the calling number is not limited to switches.
   Any subscriber with digital access (e.g., ISDN) to the system can
   generate any calling number it chooses.  Because the local switch



Rescorla & Jennings     Expires September 1, 2008               [Page 5]

Internet-Draft                SIP Identity                 February 2008


   knows which numbers are assigned to a given subscriber, it can in
   principle filter these assertions but even this is often not done.
   In other cases, subscribers can opt out of this kind of filtering in
   order to be allowed to assert numbers of their choice.

   The phone number to name mapping provided with caller id is even less
   trustworthy, since the databases are simply populated via the phone
   company's records, and they make no attempt to verify your real-world
   identity provided that you pay your bill.

   In summary, the caller identification service provided by the PSTN is
   completely untrustworthy, except as an assertion of the caller's
   intent.


3.  References

3.1.  Normative References

3.2.  Informational References

   [RFC4346]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.1", RFC 4346, April 2006.

   [RFC4347]  Rescorla, E. and N. Modadugu, "Datagram Transport Layer
              Security", RFC 4347, April 2006.

   [RFC4474]  Peterson, J. and C. Jennings, "Enhancements for
              Authenticated Identity Management in the Session
              Initiation Protocol (SIP)", RFC 4474, August 2006.

   [I-D.ietf-avt-dtls-srtp]
              McGrew, D. and E. Rescorla, "Datagram Transport Layer
              Security (DTLS) Extension to Establish Keys for  Secure
              Real-time Transport Protocol (SRTP)",
              draft-ietf-avt-dtls-srtp-02 (work in progress),
              February 2008.

   [securityfocus-call-theft]
              Poulsen, K., "Commission Hearing Probes Vegas Vice Hacks".











Rescorla & Jennings     Expires September 1, 2008               [Page 6]

Internet-Draft                SIP Identity                 February 2008


Authors' Addresses

   Eric Rescorla
   RTFM, Inc.
   2064 Edgewood Drive
   Palo Alto, CA  94303
   USA

   Email:  ekr@rtfm.com


   Cullen Jennings
   Cisco
   170 West Tasman Drive
   MS: SJC-21/2
   San Jose, CA  95134
   USA

   Phone:  +1 408 421-9990
   Email:  fluffy@cisco.com































Rescorla & Jennings     Expires September 1, 2008               [Page 7]

Internet-Draft                SIP Identity                 February 2008


Full Copyright Statement

   Copyright (C) The IETF Trust (2008).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Rescorla & Jennings     Expires September 1, 2008               [Page 8]

